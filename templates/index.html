<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZHAKE BRAINROT | WINTER</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00d4ff; --bg: #000814; }
        * { font-family: 'Inter', sans-serif !important; font-weight: 900 !important; text-transform: uppercase; }
        body { background: var(--bg); color: white; margin: 0; overflow: hidden; height: 100vh; display: flex; align-items: center; justify-content: center; }
        
        .snowflake { position: fixed; top: -10px; color: white; font-size: 1rem; z-index: 1000; pointer-events: none; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(105vh) translateX(20px); } }

        .floor { position: fixed; bottom: 0; left: 0; width: 100%; height: 30vh; background-image: linear-gradient(to right, rgba(0, 212, 255, 0.1) 1px, transparent 1px), linear-gradient(to bottom, rgba(0, 212, 255, 0.1) 1px, transparent 1px); background-size: 60px 60px; transform: perspective(500px) rotateX(60deg); transform-origin: top; border-top: 5px solid var(--accent); z-index: 1; }
        .game-world { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 3; pointer-events: none; }
        .animal { position: absolute; bottom: 12vh; font-size: 120px; filter: drop-shadow(0 0 15px var(--accent)); will-change: transform; }

        .ui { position: relative; z-index: 100; text-align: center; }
        .title-neon { font-size: 3rem; text-shadow: 0 0 20px var(--accent); margin-bottom: 20px; }
        
        .btn { width: 340px; padding: 22px; margin: 10px; background: rgba(0, 8, 20, 0.9); border: 4px solid var(--accent); color: white; font-size: 1.2rem; cursor: pointer; border-radius: 20px; transition: 0.2s; box-shadow: 0 5px 0 var(--accent); }
        .btn:hover { background: var(--accent); color: black; transform: translateY(-3px); box-shadow: 0 8px 25px var(--accent); }
        
        .form-container { background: rgba(0, 15, 30, 0.98); border: 4px solid var(--accent); padding: 25px; border-radius: 25px; width: 380px; box-shadow: 0 0 40px rgba(0, 212, 255, 0.2); }
        .input-group { display: flex; align-items: center; margin: 12px 0; border: 3px solid var(--accent); background: #000; border-radius: 12px; overflow: hidden; }
        .icon-box { padding: 0 15px; font-size: 1.3rem; background: rgba(0, 212, 255, 0.1); border-right: 2px solid var(--accent); display: flex; align-items: center; }
        
        input, select { padding: 15px; background: transparent; border: none; color: white; width: 100%; outline: none; font-size: 1.1rem; }
        select { background: var(--accent); color: black; width: 85px; }

        .flag-btn { width: 140px; height: 90px; cursor: pointer; border: 4px solid #1a1a1a; border-radius: 15px; margin: 10px; transition: 0.3s; }
        .flag-btn:hover { border-color: var(--accent); transform: scale(1.05); }

        .my-item-card { background: #001220; border: 2px solid var(--accent); padding: 15px; margin: 10px 0; border-radius: 15px; text-align: left; }
        .hidden { display: none !important; }
        label { display: block; text-align: left; color: var(--accent); font-size: 0.7rem; margin-bottom: 3px; margin-left: 5px; }
    </style>
</head>
<body>

    <div class="floor"></div>
    <div class="game-world" id="world"></div>
    <div id="snow-container"></div>

    <div id="lang-overlay" style="position:fixed; z-index:10000; background:var(--bg); inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center;">
        <h1 class="title-neon">–Ø–ó–´–ö / –¢–Ü–õ</h1>
        <div>
            <img src="https://flagcdn.com/w320/kz.png" class="flag-btn" onclick="startApp('kz')">
            <img src="https://flagcdn.com/w320/ru.png" class="flag-btn" onclick="startApp('ru')">
        </div>
    </div>

    <div class="ui">
        <div id="main-menu" class="hidden">
            <h1 class="title-neon" id="m-title">ZHAKE MARKET</h1>
            <button class="btn" id="btn-sell" onclick="showPage('form-page')">–ü–†–û–î–ê–¢–¨ –ë–†–ï–ô–ù–†–û–¢</button><br>
            <button class="btn" id="btn-mine" onclick="showMyItems()">–ú–û–ò –¢–û–í–ê–†–´</button><br>
            <button class="btn" onclick="window.open('https://t.me/zhakebreinrot')">–ö–ê–ù–ê–õ</button>
        </div>

        <div id="form-page" class="hidden">
            <div class="form-container">
                <h2 id="f-h2" style="margin:0 0 15px 0">–ü–†–û–î–ê–ñ–ê –ë–†–ï–ô–ù–†–û–¢–û–í</h2>
                <form id="anketaForm">
                    <label id="l-inc">–ü–†–ò–ë–´–õ–¨ –ë–†–ï–ô–ù–†–û–¢–ê –í –°–ï–ö–£–ù–î–£:</label>
                    <div class="input-group">
                        <div class="icon-box">ü™ô</div>
                        <input type="number" id="v_inc" min="1" max="999" placeholder="100" required>
                        <select id="s_inc"><option>M</option><option>B</option><option>T</option><option>Q</option></select>
                    </div>
                    <label id="l-pri">–¶–ï–ù–ê –ë–†–ï–ô–ù–†–û–¢–ê:</label>
                    <div class="input-group">
                        <div class="icon-box">üíµ</div>
                        <input type="number" id="v_pri" placeholder="5000" required>
                        <select id="s_pri"><option>‚Ç∏</option><option>‚ÇΩ</option></select>
                    </div>
                    <label id="l-wa">WHATSAPP –ù–û–ú–ï–†:</label>
                    <div class="input-group">
                        <div class="icon-box">üì±</div>
                        <input type="text" id="v_wa" placeholder="77071234567" required>
                    </div>
                    <label id="l-ph">–§–û–¢–û –ë–†–ï–ô–ù–†–û–¢–ê:</label>
                    <div class="input-group">
                        <div class="icon-box">üíé</div>
                        <input type="file" id="v_ph" accept="image/*" required style="font-size:0.7rem">
                    </div>
                    <button type="submit" class="btn" id="btn-sub" style="width:100%; margin-top:10px">–û–¢–ü–†–ê–í–ò–¢–¨</button>
                </form>
                <div style="cursor:pointer; margin-top:15px; color:#555" onclick="showPage('main-menu')">‚Üê –ù–ê–ó–ê–î</div>
            </div>
        </div>

        <div id="items-page" class="hidden">
            <div class="form-container">
                <h2>–í–ê–®–ò –ê–ù–ö–ï–¢–´</h2>
                <div id="items-container" style="max-height:300px; overflow-y:auto;"></div>
                <button class="btn" style="width:100%; margin-top:15px;" onclick="showPage('main-menu')">–ù–ê–ó–ê–î</button>
            </div>
        </div>
    </div>

    <script>
        function createSnowflake() {
            const snow = document.createElement('div');
            snow.className = 'snowflake'; snow.innerHTML = '‚ùÑ';
            snow.style.left = Math.random() * 100 + 'vw';
            const duration = Math.random() * 3 + 2;
            snow.style.animationDuration = duration + 's';
            document.getElementById('snow-container').appendChild(snow);
            setTimeout(() => snow.remove(), duration * 1000);
        }
        setInterval(createSnowflake, 150);

        const animals = ['üêä', 'üê±', 'üêï', 'ü¶ñ', 'üê∏'];
        function spawn() {
            const a = document.createElement('div'); a.className = 'animal';
            a.innerText = animals[Math.floor(Math.random()*animals.length)];
            a.style.left = '-200px'; document.getElementById('world').appendChild(a);
            let pos = -200;
            function walk() {
                pos += 2.5; a.style.left = pos + 'px';
                a.style.bottom = (12 + Math.sin(Date.now()*0.01)*3) + 'vh';
                if(pos < window.innerWidth + 200) requestAnimationFrame(walk); else a.remove();
            }
            walk();
        }
        setInterval(spawn, 3500);

        const trans = {
            ru: { title: "ZHAKE MARKET", sell: "–ü–†–û–î–ê–¢–¨ –ë–†–ï–ô–ù–†–û–¢", mine: "–ú–û–ò –¢–û–í–ê–†–´", h2: "–ü–†–û–î–ê–ñ–ê –ë–†–ï–ô–ù–†–û–¢–û–í", inc: "–ü–†–ò–ë–´–õ–¨ –í –°–ï–ö–£–ù–î–£:", pri: "–¶–ï–ù–ê –ë–†–ï–ô–ù–†–û–¢–ê:", wa: "WHATSAPP –ù–û–ú–ï–†:", sub: "–û–¢–ü–†–ê–í–ò–¢–¨" },
            kz: { title: "–ñ–ê–ö–ï –ú–ê–†–ö–ï–¢", sell: "–ë–†–ï–ô–ù–†–û–¢ –°–ê–¢–£", mine: "–ú–ï–ù–Ü“¢ –¢–ê–£–ê–†–õ–ê–†–´–ú", h2: "–ë–†–ï–ô–ù–†–û–¢ –°–ê–¢–£", inc: "–°–ï–ö–£–ù–î–´–ù–ê –ü–ê–ô–î–ê:", pri: "–ë–†–ï–ô–ù–†–û–¢ –ë–ê“í–ê–°–´:", wa: "WHATSAPP –ù”®–ú–Ü–†–Ü:", sub: "–ñ–Ü–ë–ï–†–£" }
        };

        function startApp(l) {
            document.getElementById('m-title').innerText = trans[l].title;
            document.getElementById('btn-sell').innerText = trans[l].sell;
            document.getElementById('btn-mine').innerText = trans[l].mine;
            document.getElementById('f-h2').innerText = trans[l].h2;
            document.getElementById('l-inc').innerText = trans[l].inc;
            document.getElementById('l-pri').innerText = trans[l].pri;
            document.getElementById('l-wa').innerText = trans[l].wa;
            document.getElementById('btn-sub').innerText = trans[l].sub;
            document.getElementById('lang-overlay').classList.add('hidden');
            document.getElementById('main-menu').classList.remove('hidden');
        }

        function showPage(id) {
            ['main-menu', 'form-page', 'items-page'].forEach(p => document.getElementById(p).classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function showMyItems() {
            const cont = document.getElementById('items-container');
            cont.innerHTML = '';
            let myData = JSON.parse(localStorage.getItem('my_data') || "[]");
            myData.forEach(item => {
                cont.innerHTML += `<div class="my-item-card">
                    <div style="color:var(--accent)">–õ–û–¢ #${item.id}</div>
                    <div>+${item.inc}${item.sym}/–°–ï–ö | ${item.pri}${item.cur}</div>
                    <div style="color:#0f0; font-size:0.8rem">–û–ü–£–ë–õ–ò–ö–û–í–ê–ù</div>
                </div>`;
            });
            showPage('items-page');
        }

        document.getElementById('anketaForm').onsubmit = async (e) => {
            e.preventDefault();
            const fd = new FormData();
            const v_inc = document.getElementById('v_inc').value;
            const s_inc = document.getElementById('s_inc').value;
            const v_pri = document.getElementById('v_pri').value;
            const s_pri = document.getElementById('s_pri').value;

            fd.append('money_val', v_inc); fd.append('money_sym', s_inc);
            fd.append('price_val', v_pri); fd.append('price_cur', s_pri);
            fd.append('whatsapp', document.getElementById('v_wa').value);
            fd.append('photo', document.getElementById('v_ph').files[0]);

            const res = await fetch('/send_anketa', { method: 'POST', body: fd });
            const data = await res.json();
            if(data.status === "success") {
                let myData = JSON.parse(localStorage.getItem('my_data') || "[]");
                myData.push({ id: data.id, inc: v_inc, sym: s_inc, pri: v_pri, cur: s_pri });
                localStorage.setItem('my_data', JSON.stringify(myData));
                alert("–û–¢–ü–†–ê–í–õ–ï–ù–û!");
                showPage('main-menu');
            } else {
                alert("–û–®–ò–ë–ö–ê: " + data.message);
            }
        };
    </script>
</body>
</html>